<!DOCTYPE html>
<html>
	<head>
		<style>
html, body, #main {
	height: 100%;
}
body {
	margin: 0;
	font-family: sans-serif;
}
.card {
	background: blue;
	border: 1em solid black;
	border-radius: 2em;
	height: calc(100% - 2em);
	display: flex;
	justify-content: center;
	align-items: center;
}
.card.success {
	background: green;
}
.card div {
	font-size: 2em;
	color: white;
	font-weight: bold;
}
		</style>
		<style>
.rotation {
	width: calc(var(--amount) * 10em);
	background: lime;
}
.rotation::after {
	content: var(--samount);
	height: 1em;
	display: inline-block;
	width: 100vw;
}
		</style>
	</head>
	<body>
		<div id="main">
			<!-- <div id="rot0" class="rotation"></div>
			<div id="rot1" class="rotation"></div>
			<div id="rot2" class="rotation"></div>
			<div id="rot3" class="rotation"></div> -->
			<!-- <div id="rot4" class="rotation"></div>
			<div id="rot5" class="rotation"></div>
			<div id="rot6" class="rotation"></div> -->
		</div>
		<script>window.addEventListener("error", (e) => alert(`${e.stack}`))</script>
		<script>
var words = [
	"Goober",
	"Dad",
	"Jason",
	"Dad the goober",
	"Jason the not goober"
]
var current_word = ""
var success_words = []



// What? I like Python.
const random = {
	randomTo: (i) => {
		return Math.floor(random.random() * i)
	},
	choice: (i) => {
		return i[random.randomTo(i.length)]
	},
	randint: (start, stop) => {
		return start + random.randomTo((stop - start) + 1)
	},
	random: () => {
		return Math.random()
	}
}



function showWord(w) {
	current_word = w
	document.querySelector("#main").innerText = ""
	var e = document.createElement("div")
	e.classList.add("card")
	e.appendChild(document.createElement("div"))
	e.children[0].innerText = w
	document.querySelector("#main").appendChild(e)
}
function showSuccess() {
	document.querySelector("#main").innerText = ""
	var e = document.createElement("div")
	e.classList.add("card")
	e.classList.add("success")
	e.appendChild(document.createElement("div"))
	e.children[0].innerText = "Correct!"
	document.querySelector("#main").appendChild(e)
}
var screen = 0
function screenWord() {
	if (screen < 0) {
		screen += 1
		if (screen == 0) showWord(random.choice(words))
	} else if (screen > 0) {
		screen -= 1
		if (screen == 0) showWord(random.choice(words))
	}
}
function screenSuccess() {
	if (screen >= 0) {
		showSuccess()
		success_words.push(current_word)
	}
	screen = -60
}



// const options = { frequency: 60, referenceFrame: "device" };
// const sensor = new AbsoluteOrientationSensor(options);

// Promise.all([
// 	navigator.permissions.query({ name: "accelerometer" }),
// 	navigator.permissions.query({ name: "magnetometer" }),
// 	navigator.permissions.query({ name: "gyroscope" }),
// ]).then((results) => {
// 	if (results.every((result) => result.state === "granted")) {
// 		sensor.start();
// 	} else {
// 		console.log("No permissions to use AbsoluteOrientationSensor.");
// 	}
// });

// sensor.addEventListener("reading", () => {
// 	console.log(sensor.quaternion)
// });
// sensor.addEventListener("error", (error) => {
// 	if (event.error.name === "NotReadableError") {
// 		console.error("Sensor is not available.");
// 	}
// });
// function alphaBetaGammaToQuaternion(alpha, beta, gamma) {
// 	var rad = Math.PI / 180;
// 	var phi = alpha * rad;
// 	var theta = beta * rad;
// 	var psi = gamma * rad;

// 	var _x = phi * 0.5;
// 	var _y = theta * 0.5;
// 	var _z = psi * 0.5;

// 	var cX = Math.cos(_x);
// 	var cY = Math.cos(_y);
// 	var cZ = Math.cos(_z);

// 	var sX = Math.sin(_x);
// 	var sY = Math.sin(_y);
// 	var sZ = Math.sin(_z);

// 	return [
// 		cX * cY * cZ - sX * sY * sZ,
// 		cX * cZ * sY - cY * sX * sZ,
// 		cX * cY * sZ + cZ * sX * sY,
// 		cY * cZ * sX + cX * sY * sZ
// 	];
// }
window.addEventListener("deviceorientation", handleOrientation, true);
function handleOrientation(e) {
	// console.log("a=", Math.floor(e.alpha / 45) * 45, "b=", Math.floor(e.beta / 45) * 45, "c=", Math.floor(e.gamma / 45) * 45)
	// document.querySelector("#rot0").setAttribute("style", `--samount: "alpha: ${e.alpha}"; --amount: ${(e.alpha + 180) / 100};`)
	// document.querySelector("#rot1").setAttribute("style", `--samount: "beta: ${e.beta}"; --amount: ${(e.beta + 180) / 100};`) // ${e.beta>10 ? " background: red;" : ""}
	// document.querySelector("#rot2").setAttribute("style", `--samount: "gamma: ${e.gamma}"; --amount: ${(e.gamma + 180) / 100};`)
	var amt = e.gamma
	if (amt < 0) amt += 180
	// document.querySelector("#rot3").setAttribute("style", `--samount: "amt: ${amt}"; --amount: ${amt / 100};`)
	// if (e.beta > 10) screenSuccess()
	// else screenWord()
	if (amt < 60) screenSuccess()
	// else if (amt > 150) screenSkip()
	else screenWord()
}
		</script>
	</body>
</html>